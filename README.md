# LeoEcsLiteProbe

## Unity-независимый функционал

Основная игровая логика не зависит от Unity. Код основных систем, компонентов и базовых вещей лежит в папках

```
Game/Code/Core
Game/Code/Components
Game/Code/Systems
```

В папке Core лежит:

1) описание структур данных, используемых для конфигурирования игры (позиции точек взаимодействия, константы для настроек): DoorData, LevelData, GameConstants.
2) Вспомогательный класс EcsMessenger, служаший для передачи событий за счет создания сущностей с нужными компонентами в мире events.
3) Расширения LeoEcsExtensions (пока одно) для более удобного добавления/замены данных компонентов.
4) В папке ServiceInterfaces лежит интерфейс для независимого счетчика времени (нужен для работы систем, завязанных на время).

В папке Components
1) DoorComponent - для сущностей дверей.
2) IsMovingComponent - флаг движения сущности.
3) MoveComponent - при накидывании на сущность, имеющую позицию, заставляет ее двигаться в указанную точку.
4) PlayerComponent - флаг игрока на сущности.
5) PositionComponent - позиция.
6) Папка Events_Requests (здесь тоже компоненты, но для событий): создание сущности двери и запрос движения игрока.

В папке Systems
1) DoorOpeningSystem - система, проверяющая, не активировано ли открытие какой-либо двери.
2) DoorsSpawnSystem - система, создающая сущности дверей по полученному конфигу.
3) EventsClearSystem - система, удаляющая сущности событий в конце кадра.
4) MoveSystem - двигает сущности с MoveComponent (в конце движения снимает компонент).
5) PlayerMoveSystem - система накидывающая движение на игрока в ответ на запрос PlayerMoveRequest.
6) PlayerSpawnSystem - создает сущность игрока.

## Функционал в Unity

В папке IntermediateSystems
1) DoorsShowingSystem - через сервис связывает DoorView дверей на сцене с соответствующими сущностями для отображения.
2) PlayerPointAndClickSystem - система отправляет запросы на движение игрока (PlayerMoveRequest) при кликах на сцене.

В папке Unity
1) CameraController - двигает камеру за игроком.
2) DoorView - вьюшка двери.
3) EcsMotor - для работы Ecs-систем (вообще-то не зависит от Unity, но использует интерфейсы из Zenject, поэтому положил сюда).
4) EcsWorlds - для передачи миров из ECS во вьюшки на сцене.
5) PlayerView - вьюшка игрока.
6) SceneDoorsService - сервис для связывания вьюшек дверей с соответствующими сущностями.
7) UnityTimeService - реализация ITimeService под Unity.

В папке Zenject
1) Инсталлер сцены уровня.
2) Расширение DiContainer для удобного инсталла ECS-систем.


В сумме на разработку/решение возникших проблем с фреймворком потрачено 24 часа.
